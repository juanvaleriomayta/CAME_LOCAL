CREATE OR REPLACE FORCE VIEW came.vw_participantea (codigo,foto,dni,nombre,apellido,nacimiento,lugarnac,estadocivil,sexo,celular,domicilio,distrito,conyuge,profconyuge,empresa,ruc,domiciliofiscal,teletrab,emailtraba,actiemp,area,puesto,yearpues,npersonas,jefe,cargojefe,telfjefe,emailjefe,actividadper,"AUTO",marca,placa,organigrama,gradoaca,univaca,espaca,pro1,pro2,pro3,dura1,dura2,dura3,inst1,inst2,inst3,con1,con2,con3,con4,con5,inte1,inte2,inte3,inte4,inte5,seguroper,telefonoseg,peremer,telfemer,pre1,pre2,coment,estent,fecent,entrevistador) AS
SELECT PERSONA.CODPER AS "CODIGO",
PERSONA.IMGPER AS "FOTO",
PERSONA.DNIPER AS "DNI",
PERSONA.NOMPER AS "NOMBRE",
PERSONA.APEPER AS "APELLIDO",
to_char(PERSONA.FECHPER,'DD/MM/YYYY') AS "NACIMIENTO",
PERSONA.LUGNAC AS "LUGARNAC",
PERSONA.ESTCIV AS "ESTADOCIVIL",
CASE
    WHEN PERSONA.SEXPER = 'M' THEN 'Masculino'
    WHEN PERSONA.SEXPER = 'F' THEN 'Femenino'
END AS SEXO,
PERSONA.CELPER AS "CELULAR",
PERSONA.DIRPER AS "DOMICILIO",
CONCAT(CONCAT(UBIGEO.PROVUBI ,','), UBIGEO.DISTUBI) AS "DISTRITO",
PERSONA_DET.CONYUGE AS "CONYUGE",
PERSONA_DET.PROFCONY AS "PROFCONYUGE",
EMPRESA.NOMBEMP AS "EMPRESA",
EMPRESA.RUCEMP AS "RUC",
EMPRESA.DIREMP AS "DOMICILIOFISCAL",
PERSONA_DET.TELFTRAB AS "TELETRAB",
PERSONA_DET.EMAILTRAB AS "EMAILTRABA",
EMPRESA.ACTEMP AS "ACTIEMP",
PERSONA_DET.AREATRAB AS "AREA",
PERSONA.CARGOPER AS "PUESTO",
PERSONA_DET.YEARPUESTO AS "YEARPUES",
PERSONA_DET.NUMPERCARGO AS "NPERSONAS",
PERSONA_DET.JEFEMP AS "JEFE",
PERSONA_DET.JEFCARGO AS "CARGOJEFE",
PERSONA_DET.JEFTELF AS "TELFJEFE",
PERSONA_DET.JEFEMAIL AS "EMAILJEFE",
PERSONA_DET.ACTPER AS "ACTIVIDADPER",
PERSONA_DET.AUTOPER AS "AUTO",
PERSONA_DET.MARCAUT AS "MARCA",
PERSONA_DET.PLACAUT AS "PLACA",
PERSONA_DET.IMGORG AS "ORGANIGRAMA",
PERSONA_DET.GRAPER AS "GRADOACA",
PERSONA_DET.UNIPER AS "UNIVACA",
PERSONA_DET.ESPPER AS "ESPACA",
PERSONA_DET.PROACA1 AS "PRO1",
PERSONA_DET.PROACA2 AS "PRO2",
PERSONA_DET.PROACA3 AS "PRO3",
PERSONA_DET.DURACA1 AS "DURA1",
PERSONA_DET.DURACA2 AS "DURA2",
PERSONA_DET.DURACA3 AS "DURA3",
PERSONA_DET.INSACA1 AS "INST1",
PERSONA_DET.INSACA2 AS "INST2",
PERSONA_DET.INSACA3 AS "INST3",
PERSONA_DET.CO1 AS "CON1",
PERSONA_DET.CO2 AS "CON2",
PERSONA_DET.CO3 AS "CON3",
PERSONA_DET.CO4 AS "CON4",
PERSONA_DET.CO5 AS "CON5",
PERSONA_DET.INT1 AS "INTE1",
PERSONA_DET.INT2 AS "INTE2",
PERSONA_DET.INT3 AS "INTE3",
PERSONA_DET.INT4 AS "INTE4",
PERSONA_DET.INT5 AS "INTE5",
PERSONA_DET.SEGURO AS "SEGUROPER",
PERSONA_DET.TELFSEGURO AS "TELEFONOSEG",
PERSONA_DET.EMERNOMB AS "PEREMER",
PERSONA_DET.EMERTELF AS "TELFEMER",
ENTREVISTA.PRE1 AS "PRE1",
ENTREVISTA.PRE2 AS "PRE2",
ENTREVISTA.COMENT AS "COMENT",
CASE
    WHEN ENTREVISTA.ESTENT = '1' THEN 'Participante apto'
    WHEN ENTREVISTA.ESTENT = '0' THEN 'Participante no apto'
END AS ESTENT,
TO_CHAR(ENTREVISTA.FECENT,'DD/MM/YYYY') AS "FECENT",
(ENTREVISTADOR.NOMPER ||' ' || ENTREVISTADOR.APEPER) AS "ENTREVISTADOR"
FROM PERSONA INNER JOIN PERSONA_DET ON PERSONA.CODPER = PERSONA_DET.CODPER
INNER JOIN ENTREVISTA ON PERSONA.CODPER = ENTREVISTA.CODPER
INNER JOIN PERSONA ENTREVISTADOR ON PERSONA.CODPER = ENTREVISTADOR.CODPER
INNER JOIN EMPRESA ON PERSONA.CODEMP = EMPRESA.CODEMP 
INNER JOIN UBIGEO ON PERSONA.CODUBI = UBIGEO.CODUBI 
INNER JOIN ASIGNACION ON ASIGNACION.CODPER = PERSONA.CODPER WHERE ASIGNACION.ESTREG='A';